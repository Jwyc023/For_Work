# 6.1 计算机网络之应用层概述(C/S模型与p2p模型)

## 应用层概述

![6.1. 应用层概述](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.1. 应用层概述.png)

## 网络应用模型

### 客户/服务器模型（C/S）

![6.1. 客户服务器模型（CS）](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.1. 客户服务器模型（CS）.png)

### P2P模型

在P2P模型中，各计算机没有固定的客户和服务器划分。相反，任意一一对计算机一称为对等方(Peer)， 直接相互通信。
P2P 模型从本质上来看仍然使用客户/服务器方式，每个结点既作为客户访问其他结点的资源，也作为服务器提供资源给其他结点访问。
当前比较流行的P2P应用有PPlive、Bittorrent 和电驴等。

![6.1. P2P模型](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.1. P2P模型.png)

**与C/S模型相比，P2P 模型的优点主要体现如下:**

1)减轻了服务器的计算压力，消除了对某个服务器的完全依赖，可以将任务分配到各个结点上，因此大大提高了系统效率和资源利用率(例如，播放流媒体时对服务器的压力过大，而通过P2P模型，可以利用大量的客户机来提供服务)。
2)多个客户机之间可以直接共享文档。
3)可扩展性好，传统服务器有响应和带宽的限制，因此只能接受- -定 数量的请求。
4)网络健壮性强，单个结点的失效不会影响其他部分的结点。

P2P模型也有缺点。在获取服务的同时,还要给其他结点提供服务，因此会占用较多的内存，影响整机速度。
例如，经常进行P2P下载还会对硬盘造成较大的损伤。据某互联网调研机构统计，当前P2P程序已占互联网50%~90%的流量，使网络变得非常拥塞，因此各大ISP (互联网服务2提供商，如电信、网通等)通常都对P2P应用持反对态度。

# 6.2 详解DNS域名解析系统（域名、域名服务器[根、顶级、授权/权限、本地]、域名解析过程[递归与迭代]）

## DNS系统

域名系统(Domain Name System, DNS)是因特网使用的命名系统，用来把便于人们记忆的具有特定含义的主机名(如www.BitHachi.com)转换为便于机器处理的IP地址。
相对于IP地址，人们更喜欢使用具有特定含义的字符串来标识因特网上的计算机。
DNS系统采用客户/服务器模型，其协议运行在UDP之上，使用53号端口。
从概念上可将DNS分为3部分:层次域名空间、域名服务器和解析器。

某台主机访问网站www.bithachi.cn网站为例，DNS的大致流程

![6.2. DNS大致流程](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.2. DNS大致流程.png)

## 域名

- 因特网采用层次树状结构的命名方法。采用这种命名方法，任何一个连接到因特网的主机或路由器，都有一个唯一的层次结构名称，即域名(Domain Name)。
- 域(Domain)是名字空间中一个可被管理的划分。
- 域还可以划分为子域，而子域还可以继续划分为子域的子域，这样就形成了顶级域、二级域、三级域等。

**在域名系统中，每个域分别由不同的组织进行管理。每个组织都可以将它的域再分成一定数目的子域，并将这些子域委托给其他组织去管理。**

- 例如，管理CN域的中国将EDU.CN子域授权给中国教育和科研计算机网(CERNET)来管理。
- 比如我的域名bithachi.cn是一个二级域名，我可以任意分配三级域名，比如1001.bithachi.cn和1002.bithachi.cn，这两个网址是可以访问的，小项目。

**域名空间的树状结构：**

![6.2. 域名空间的树状结构](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.2. 域名空间的树状结构.png)

 每个域名都由`标号`序列组.成，而各标号之间用点`(“.”)`隔开。

**关于域名中的标号有以下几点需要注意**

- 1)标号中的英文`不区分大小写`。.
- 2)标号中除连字符(-) 外不能使用其他的标点符号。
- 3)每个标号不超过63个字符，多标号组成的完整域名最长不超过255个字符。
- 4)级别最低的域名写在最左边，级别最高的顶级域名写在最右边。

## 域名服务器

因特网的域名系统被设计成一个联机分布式的数据库系统，并采用客户/服务器模型。

域名到IP地址的解析是由运行在域名服务器上的程序完成的，一个服务器所负责管辖的(或有权限的)范围称为区(不以“域”为单位)，各单位根据具体情况来划分自己管辖范围的区，但在一个区中的所有结点必须是能够连通的，每个区设置相应的权限域名服务器，用来保存该区中的所有主机的域名到IP地址的映射。

每个域名服务器不但能够进行一些域名到IP地址的解析，而且还必须具有连向其他域名服务器的信息。当自己不能进行域名到IP地址的转换时，能够知道到什么地方去找其他域名服务器。

DNS使用了大量的域名服务器，它们以层次方式组织。没有一台域名服务器具有因特网上所有主机的映射，相反，该映射分布在所有的DNS上。

采用分布式设计的DNS，是一个在因特网上实现分布式数据库的精彩范例。主要有4种类型的域名服务器。

![6.2. 域名服务器](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.2. 域名服务器.png)

### 根域名服务器

根域名服务器是最高层次的域名服务器，所有的根域名服务器都知道所有的顶级域名服务器的IP地址。
根域名服务器也是最重要的域名服务器，不管是哪个本地域名服务器，若要对因特网上任何一个域名进行解析，只要自己无法解析，就首先要求助于根域名服务器。
因特网上有13个根域名服务器，尽管我们将这13个根域名服务器中的每个都视为单个服务器，但每个“服务器”实际上是冗余服务器的集群，以提供安全性和可靠性。
需要注意的是，根域名服务器用来管辖顶级域(如.com)， 通常它并不直接把待查询的域名直接转换成IP地址，而是告诉本地域名服务器下一步应当找哪个顶级域名服务器进行查询。

### 顶级域名服务器

这些域名服务器负责`管理在该顶级域名服务器注册的所有二级域名`。

收到DNS查询请求时,就给出相应的回答(可能是最后的结果，也可能是下一步应当查找的域名服务器的IP地址)。

### 授权域名服务器(权限域名服务器)

`每台主机`都必须在`授权域名服务器`处登记。为了更加可靠地工作，一台主机最好至少有两个授权域名服务器。

实际上，许多`域名服务器`都`同时`充当`本地域名服务器`和`授权域名服务器`。

`授权域名服务器`总能将其管辖的`主机名`转换为该主机的`IP地址`。

### 本地域名服务器

本地域名服务器对域名系统非常重要。
每个因特网服务提供者(ISP)， 或一所大学，甚至一所大学中的各个系，都可以拥有一个本地域名服务器。
当一台主机发出DNS查询请求时，这个查询请求报文就发送给该主机的本地域名服务器。
事实上，我们在Windows系统中配置“本地连接”时，就需要填写DNS地址，这个地址就是本地DNS (域名服务器)的地址。

## 域名解析过程

- `域名解析是指把域名映射成为IP地址或把IP地址映射成域名的过程。前者称为正向解析，后者称为反向解析。`
- 当客户端需要域名解析时，通过本机的DNS客户端构造一个`DNS请求报文`，以`UDP数据报`方式发往`本地域名服务器`。
- 域名解析有两种方式:`递归查询`和`递归与迭代`相结合的查询。

### 递归查询方式

**递归查询的过程如下图所示**， 由于该方法给根域名服务造成的负载过大，所以在实际中几乎不使用。

![6.2. 递归查询方式](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.2. 递归查询方式.png)

### 常用递归与迭代相结合的查询方式

**常用递归与迭代相结合的查询方式如下图所示，该方式分为两个部分。**

![6.2. 常用递归与迭代相结合的查询方式](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.2. 常用递归与迭代相结合的查询方式.png)

**主机向本地域名服务器的查询采用的是递归查询**

也就是说，如果本地主机所询问的本地域名服务器不知道被查询域名的IP 地址，那么本地域名服务器就以DNS客户的身份，向根域名服务器继续发出查询请求报文(即替该主机继续查询)，而不是让该主机自己进行下一步的查询。
在这种情况下，本地域名服务器只需向根域名服务器查询一次，后面的几次查询都是递归地在其他几个域名服务器之间进行的[见图6.6(a)中的步骤③~⑥]。
在步骤⑦中，本地域名服务器从根域名服务器得到了所需的IP地址,最后在步骤⑧中，本地域名服务器把查询结果告诉主机m.xyz.com.

**本地域名服务器向根域名服务器的查询采用迭代查询**

当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的IP地址，要么告诉本地域名服务器:“你下一步应当向哪个顶级域名服务器进行查询”。
然后让本地域名服务器向这个顶级域名服务器进行后续的查询，如图6.6(b)所示。
同样，顶级域名服务器收到查询报文后，要么给出所要查询的IP地址，要么告诉本地域名服务器下一步应向哪个·权限域名服务器·查询。
最后，知道所要解析的域名的IP地址后，把这个结果返回给发起查询的主机。

> 为了提高DNS的查询效率，并减少因特网上的DNS查询报文数量，在域名服务器中广泛地使用了高速缓存。
> 当一个DNS服务器接收到DNS查询结果时，它能将该DNS信息缓存在高速
> 缓存中。这样，当另一个相同的域名查询到达该DNS服务器时，该服务器就能够直接提供所要求的IP地址，而不需要再去向其他DNS服务器询问。
> 因为主机名和IP地址之间的映射不是永久的，所以DNS服务器将在一段时间后丢弃高速缓存中的信息。

# 6.3 FTP协议

## FTP协议的功能

- 文件传输协议( File Transfer Protocol, FTP)是因特网上使用得最广泛的`文件传输协议。`
- FTP提供`交互式的访问`，允许客户指明文件的类型与格式，并允许文件具有`存取权限`。
- 它屏蔽了各计算机系统的细节，因而适合于在异构网络中的`任意计算机之间传送文件`。

**FTP提供以下功能:**

①提供不同种类主机系统(硬、软件体系等都可以不同)之间的文件传输能力。
 ②`以用户权限管理的方式提供用户对远程FTP服务器上的文件管理能力`。
 ③以`匿名FTP`的方式提供`公用文件共享`的能力。

![6.3. FTP提供以下功能](D:\学习用\找工作\For_Work\Github面试题\JwycDocs\计算机网络图片\6.3. FTP提供以下功能.png)

## FTP工作原理

FTP采用客户/服务器（C/S）的工作方式，它使用TCP可靠的传输服务。
一个FTP服务器进程可同时为多个客户进程提供服务。
依照FTP协议提供服务，进行文件传送的计算机就是FTP服务器。
连接FTP服务器，遵循FTP协议与服务器传送文件的电脑就是FTP客户端。
FTP的服务器进程由两大部分组成:
一个主进程，负责接收新的请求;
若干从属进程，负责处理单个请求。



