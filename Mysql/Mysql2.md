# 索引2

这里记录一些问题：

1. 

   ![回表与索引覆盖](D:\学习用\找工作\For_Work\Mysql\MYSQL索引.assets\回表与索引覆盖.png)

   即：如果查询的列不在索引里，那么就需要聚簇索引去访问具体数据，就叫回表。

   最左匹配：or？

   索引下推

   <img src="D:\学习用\找工作\For_Work\Mysql\MYSQL索引.assets\索引下推.png" alt="索引下推" style="zoom:80%;" />

   索引下推（index condition pushdown ）简称ICP，在Mysql5.6的版本上推出，用于优化查询。

   在不使用ICP的情况下，在使用非主键索引（又叫普通索引或者二级索引）进行查询时，存储引擎通过索引检索到数据，然后返回给MySQL服务器，服务器然后判断数据是否符合条件 。

   在使用ICP的情况下，如果存在某些被索引的列的判断条件时，MySQL服务器将这一部分判断条件传递给存储引擎，然后由存储引擎通过判断索引是否符合MySQL服务器传递的条件，只有当索引符合条件时才会将数据检索出来返回给MySQL服务器 。

   索引条件下推优化可以减少存储引擎查询基础表的次数，也可以减少MySQL服务器从存储引擎接收数据的次数。 

2. 索引和数据是存在磁盘的，在进行数据读取时会优先把索引加载进内存中
3. 存储引擎：不同的数据文件在磁盘的不同组织形式
4. 操作系统
   1. 局部性原理
      1. 时间：之前被访问的数据很有可能被再次访问
      2. 空间：数据和程序都有聚集成群的倾向
   2. 磁盘预读：内存跟磁盘交互时，有个最小单位“页”，



# 隔离机制

1. 读未提交

   如果一个事务读取到了另一个未提交事务修改过的数据，那么这种隔离级别就称之为读未提交。



# 锁

https://www.cnblogs.com/111testing/p/11371236.html

# MVCC

并发场景下提高读写效率

1. 当前读

   总是读取最新的数据

2. 快照读

   读取历史版本的记录（undo log）

## ReadView

![readview](D:\学习用\找工作\For_Work\Mysql\Mysql事务.assets\readview.png)

其实就是时间轴的问题。这就是RR隔离里面为什么能做到可重复读了，因为readview的生成时间会帮助事务A去判断事务B的修改时间，从而确定能不能看到修改后的值。RC每次快照读的时候都会生成readview，RR只有在第一次读的时候会生成readview。



# 四个特性

<img src="D:\学习用\找工作\For_Work\Mysql\Mysql事务.assets\四个特性及其解决方法.png" alt="四个特性及其解决方法" style="zoom:80%;" />

<img src="D:\学习用\找工作\For_Work\Mysql\Mysql事务.assets\四个特性.png" alt="四个特性" style="zoom: 50%;" />